<html>
<head>
    <link rel="stylesheet" href="./css/style.css">
    <title>Naughty/Nice List with Blockchain Investigation - Pt1: SANS Holiday Hack 2020</title>
    <script type="text/javascript" src="./scripts/chars.js"></script>
</head>
<body>
<div class="content-surround main-centered">
    <div class="content-background">
        <div id="mainContent" class="content-body">
            <div class="content">
                <!--
                Common - v2020.DEC.23
                -->



                <div class="title">Naughty/Nice List with Blockchain Investigation - Pt1: SHHC20</div>
                <div class="writeup">
                    <div class="polaroid-rotate-right">
                        <div class="polaroid-surround">
                            <div class="polaroid-frame" onclick="OpenImgModal('blockchain')">
                                <div class="polaroid-caption">ARP Shenanigans</div>
                            </div>
                            <div class="polaroid-img-bg"><div id="arp_shenanigans" class="polaroid-img" style="background-image: url('./screenshots/arp_shenanigans.png');">&nbsp;</div></div>
                        </div>
                    </div>
                    <p>In the <a href="./netwars.html" class="link">NetWars</a> roof beside <span class="char" onclick="OpenCharModal('alabaster_snowball')">Alabaster Snowball</span> is a terminal titled ARP Shenanigans.</p>
                    <p>Talking with Alabster, he states we need to do a man-in-the-middle attack on a host compromised by Jack Frost and read the contents of a file on the file system.</p>
                    <p>The SHA256 of Jack's altered block is: 58a3b9335a6ceb0234c12d35a0564c4ef0e90152d0eb2ce2082383b38028a90f.
                        If you're clever, you can recreate the original version of that block by changing the values of only 4 bytes.
                        Once you've recreated the original block, what is the SHA256 of that block?</p>
                </div>


                <div class="writeup">

Digging through the doc, I see that two pages are defined, but the second page (obj 3) is never referenced in the page tree, so its content (object 15) is never displayed.
                    So I changed the page reference in the initial catalog (obj 1) in byte 62 from 2 (0x32) to 3 (0x33).
                    Displaying this PDF shows very different content!


                    The offending block's md5 hash is b10b4a6bd373b61f32f4fd3a0cdfbf84






                    4 bytes to change - 2 in PDF, 2 in 2 fields
                    1) The naughty/nice byte (or change the sign of the)
                    2) The last byte in the text object?


indeed - the actual solution is actually quite simple, but it requires a ton of intuition about JF's attack in order to get there
                    (and that's the real meat of this question). you should be able to spot one byte which has been changed,
                    purely based on the description of the situation/question. and then spot another byte based on a
                    further assumption about his attack and some knowledge of document structure. re-reading the hinted slide
                    deck several times is a good idea too :slight_smile:  i've kept these hints fairly vague to avoid spoiling
                    the fun, but feel free to shout if you want something a bit more specific

                    pay close attention to the case sensitivity of one of the hints..
                    "that would require a very UNIque hash COLLision."

Look at a single blockchain block first and  figure out what you believe needs changing but don't wonder on the how yet.
                    Once you have a list of the pieces that would need changing, then figure out how it would work with
                    the 4-byte requirement. Also, the presentation and GitHub repository (readme) from the hints is a great help

                </div>
                <div class="objective_flag">Tanta Kringle</div>

                <div class="writeup">
                    <p>An overview of all people, places, and events can be learned in the <a href="./index.html" class="link">Introduction</a>.</p>
                </div>





                <!--
                Common - v2020.DEC.23
                -->
            </div>
            <div class="footer" style="">
                <span class="footer-text">
                    <a href="./index.html">Find Other Scrolls</a> | <a href="mailto:jeremy@uranusbytes.com">jeremy@uranusbytes.com</a> | <a href="./credits.html">Credits</a>
                </span>
            </div>
        </div>
    </div>
</div>

<div id="ImgModalDiv" class="modal2">
    <span id="ImgModalClose" class="modal-close" onclick="CloseImgModal();">&times;</span>
    <div class="polaroid-big-rotate">
        <div class="polaroid-big-surround">
            <img id="ModalImg" src="./images/blank.png" class="polaroid-big" />
        </div>
    </div>
</div>


<div id="CharModalDiv" class="modal">
    <span id="CharModalClose" class="modal-close" onclick="CloseCharModal();">&times;</span>
    <div class="char-container">
        <div class="char-child" style="flex-grow: 1; overflow: hidden;">
            <div id="CharName" class="char-name">Jingle</div>
            <img id="CharAvatar" class="char-avatar" src="./images/blank.png">
        </div>
        <div class="char-child" style="flex-grow: 1;">
            <div class="char-name">Dialog</div>
            <div id="CharDialog" class="char-dialog"></div>
        </div>
    </div>
</div>

</body>
</html>
