<html>
<head>
    <link rel="stylesheet" href="./css/style.css">
    <title>Scapy Prepper: SANS Holiday Hack 2020</title>
    <script type="text/javascript" src="./scripts/chars.js"></script>
</head>
<body>
<div class="content-surround main-centered">
    <div class="content-background">
        <div id="mainContent" class="content-body">
            <div class="content">
                <!--
                Common - v2020.DEC.23
                -->



                <div class="title">Scapy Prepper: SHHC20</div>
                <div class="writeup">
                    <div class="polaroid-rotate-right">
                        <div class="polaroid-surround">
                            <div class="polaroid-frame" onclick="OpenImgModal('img_scapy_preppers')">
                                <div class="polaroid-caption">NetWars Room</div>
                            </div>
                            <div class="polaroid-img-bg"><div id="img_scapy_preppers" class="polaroid-img" style="background-image: url('./screenshots/scapy_prepper.png');">&nbsp;</div></div>
                        </div>
                    </div>
                    <p>In the <a href="./netwars.html" class="link">NetWars roof</a> beside <span class="char" onclick="OpenCharModal('alabaster_snowball')">Alabaster Snowball</span> is the Scapy Prepper.</p>
                    <p>In talking with Alabaster, he suggests giving the Scapy Present Packet Prepper a try.</p>
                </div>
                <div class="writeup">
                    <div class="polaroid-rotate">
                        <div class="polaroid-surround">
                            <div class="polaroid-frame" onclick="OpenImgModal('img_scapy_prepper_1')">
                                <div class="polaroid-caption">Scapy Prepper</div>
                            </div>
                            <div class="polaroid-img-bg"><div id="img_scapy_prepper_1" class="polaroid-img" style="background-image: url('./screenshots/scapy_prepper_1.png');">&nbsp;</div></div>
                        </div>
                    </div>
                    <p>The answers for questions is as follows:</p>
                    <p class="question cmd-sur">Start by running the task.submit() function passing in a string argument of 'start'. <span class="cmd">task.submit('start')</span></p>
                    <p class="question cmd-sur">Submit the class object of the scapy module that sends packets at layer 3 of the OSI model. <span class="cmd">task.submit(send)</span></p>
                    <p class="question cmd-sur">Submit the class object of the scapy module that sniffs network packets and returns those
                        packets in a list. <span class="cmd">task.submit(sniff)</span></p>
                    <p class="question cmd-sur">Submit the NUMBER only from the choices below that would successfully send a TCP packet and then return the first sniffed response packet to be stored in a variable named "pkt":<br>
                        1. pkt = sr1(IP(dst="127.0.0.1")/TCP(dport=20))<br>
                        2. pkt = sniff(IP(dst="127.0.0.1")/TCP(dport=20))<br>
                        3. pkt = sendp(IP(dst="127.0.0.1")/TCP(dport=20))<br> <span class="cmd">task.submit('start')</span></p>
                    <div class="polaroid-rotate-right">
                        <div class="polaroid-surround">
                            <div class="polaroid-frame" onclick="OpenImgModal('img_scapy_prepper_2')">
                                <div class="polaroid-caption">Scapy Prepper</div>
                            </div>
                            <div class="polaroid-img-bg"><div id="img_scapy_prepper_2" class="polaroid-img" style="background-image: url('./screenshots/scapy_prepper_2.png');">&nbsp;</div></div>
                        </div>
                    </div>
                    <p class="question cmd-sur">Submit the class object of the scapy module that can read pcap or pcapng files and return
                        a list of packets.<span class="cmd">task.submit(rdpcap)</span></p>
                    <p class="question cmd-sur">The variable UDP_PACKETS contains a list of UDP packets. Submit the NUMBER only from the choices below that correctly prints a summary of UDP_PACKETS:<br>
                        1. UDP_PACKETS.print()<br>
                        2. UDP_PACKETS.show()<br>
                        3. UDP_PACKETS.list()<span class="cmd">task.submit(2)</span></p>
                    <p class="question cmd-sur">Submit only the first packet found in UDP_PACKETS.<span class="cmd">task.submit(UDP_PACKETS[0])</span></p>
                    <p class="question cmd-sur">Submit only the entire TCP layer of the second packet in TCP_PACKETS. <span class="cmd">task.submit(TCP_PACKETS[1][TCP])</span></p>
                    <div class="polaroid-rotate">
                        <div class="polaroid-surround">
                            <div class="polaroid-frame" onclick="OpenImgModal('img_scapy_prepper_3')">
                                <div class="polaroid-caption">Scapy Prepper</div>
                            </div>
                            <div class="polaroid-img-bg"><div id="img_scapy_prepper_3" class="polaroid-img" style="background-image: url('./screenshots/scapy_prepper_3.png');">&nbsp;</div></div>
                        </div>
                    </div>
                    <p class="question cmd-sur">Change the source IP address of the first packet found in UDP_PACKETS to 127.0.0.1 and then submit this modified packet. <span class="cmd">UDP_PACKETS[0][IP].src = "127.0.0.1"<br>task.submit(UDP_PACKETS[0])</span></p>
                    <p class="question cmd-sur">Submit the password "task.submit('elf_password')" of the user alabaster as found in the packet list TCP_PACKETS.<span class="cmd">task.submit(TCP_PACKETS[6][Raw].load)</span></p>
                    <p class="question cmd-sur">The ICMP_PACKETS variable contains a packet list of several icmp echo-request and icmp echo-reply packets. Submit only the ICMP chksum value from the second packet in the ICMP_PACKETS list.<span class="cmd">task.submit(ICMP_PACKETS[1][ICMP].chksum)</span></p>
                    <p class="question cmd-sur">Submit the number of the choice below that would correctly create a ICMP echo request packet with a destination IP of 127.0.0.1 stored in the variable named "pkt"<br>
                        1. pkt = Ether(src='127.0.0.1')/ICMP(type="echo-request")<br>
                        2. pkt = IP(src='127.0.0.1')/ICMP(type="echo-reply")<br>
                        3. pkt = IP(dst='127.0.0.1')/ICMP(type="echo-request")<br>
                        <span class="cmd">task.submit(3)</span></p>
                    <p class="question cmd-sur">Create and then submit a UDP packet with a dport of 5000 and a dst IP of 127.127.127.127. (all other packet attributes can be unspecified)<br>
                        <span class="cmd">task.submit(IP(dst="127.127.127.127")/UDP(dport=5000))</span></p>
                    <p class="question cmd-sur">Create and then submit a UDP packet with a dport of 53, a dst IP of 127.2.3.4, and is a DNS query with a qname of "elveslove.santa". (all other packet attributes can be unspecified)<span class="cmd">task.submit(IP(dst="127.2.3.4")/UDP(dport=53)/DNS(qd=DNSQR(qname="elveslove.santa")))</span></p>
                    <p class="question cmd-sur">The variable ARP_PACKETS contains an ARP request and response packets. The ARP response (the second packet) has 3 incorrect fields in the ARP layer. Correct the second packet in ARP_PACKETS to be a proper ARP response and then task.submit(ARP_PACKETS) for inspection.<br>
                        <span class="cmd">ARP_PACKETS[1].hwsrc = "00:13:46:0b:22:ba"<br>
                        ARP_PACKETS[1].hwdst = "00:16:ce:6e:8b:24"<br>
                        ARP_PACKETS[1].op = "is-at"</span></p>
                </div>



                <div class="writeup">
                    <p>An overview of all people, places, and events can be learned in the <a href="./index.html" class="link">Introduction</a>.</p>
                </div>



                <!--
                Common - v2020.DEC.23
                -->
            </div>
            <div class="footer" style="">
                <span class="footer-text">
                    <a href="./index.html">Find Other Scrolls</a> | <a href="mailto:jeremy@uranusbytes.com">jeremy@uranusbytes.com</a> | <a href="./credits.html">Credits</a>
                </span>
            </div>
        </div>
    </div>
</div>

<div id="ImgModalDiv" class="modal2">
    <span id="ImgModalClose" class="modal-close" onclick="CloseImgModal();">&times;</span>
    <div class="polaroid-big-rotate">
        <div class="polaroid-big-surround">
            <img id="ModalImg" src="./images/blank.png" class="polaroid-big" />
        </div>
    </div>
</div>


<div id="CharModalDiv" class="modal">
    <span id="CharModalClose" class="modal-close" onclick="CloseCharModal();">&times;</span>
    <div class="char-container">
        <div class="char-child" style="flex-grow: 1; overflow: hidden;">
            <div id="CharName" class="char-name">Jingle</div>
            <img id="CharAvatar" class="char-avatar" src="./images/blank.png">
        </div>
        <div class="char-child" style="flex-grow: 1;">
            <div class="char-name">Dialog</div>
            <div id="CharDialog" class="char-dialog"></div>
        </div>
    </div>
</div>

</body>
</html>
